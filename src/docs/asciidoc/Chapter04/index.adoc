include::../attribute.adoc[]

== tips集
本章では、本コンペティションに関連する金融・データ解析一般についてのtipsを紹介します。


=== コンペティションフォーラムの紹介
J-Quantsでは、コンペティションに関連して執筆された記事の投稿やチュートリアルへのご質問をフォーラム（ "https://signate.jp/competitions/423/discussions" ）にて募集しております（コンペの登録が必要）。また、下記内容以外にも有志の方による素晴らしいスレッドがありますので、ぜひご確認ください。
[options="header, autowidth"]
|===
|*タイトル* | *URL*
|参考書籍・記事・知見共有スレッド|https://signate.jp/competitions/423/discussions/jpx-1
|Web記事投稿スレッド|https://signate.jp/competitions/423/discussions/jpx-web
|チュートリアル質問用スレッド|https://signate.jp/competitions/423/discussions/jpx
|===

=== 金融用語集

本コンペティションで必要となる専門用語を解説してくれているサイトをご紹介します。 +
もし、専門用語で困った場合は、下記リンク先のコンテンツを確認していただければ幸いです。
[options="header, autowidth"]
|===
|*タイトル* |*運営元* | *URL*
|証券用語解説集|野村證券
|https://www.nomura.co.jp/terms/
|金融・証券用語解説集|大和証券|https://www.daiwa.jp/glossary/
|ファイナンス用語集|みずほ証券|https://glossary.mizuho-sc.com/
|初めてでもわかりやすい用語集|ＳＭＢＣ日興証券|https://www.smbcnikko.co.jp/terms/index.html
|用語解説 | 三菱UFJモルガン・スタンレー証券株式会社|https://www.sc.mufg.jp/learn/terms/index.html
|金融用語解説(知るぽると)|金融広報中央委員会|https://www.shiruporuto.jp/public/document/container/yogo/
|金融・証券用語集|日本証券業協会|https://www.jsda.or.jp/jikan/word/
|用語集|EY新日本有限責任監査法人|https://www.shinnihon.or.jp/corporate-accounting/glossary/
|会計監査用語解説集|日本公認会計士協会 |https://jicpa.or.jp/cpainfo/introduction/keyword/
|財務諸表等の用語、様式及び作成方法に関する規則|e-GOV|https://elaws.e-gov.go.jp/document?lawid=338M50000040059
|用語集|野村アセットマネジメント|https://www.nomura-am.co.jp/basicknowledge/word/
|用語集|アセットマネジメントOne|http://www.am-one.co.jp/shisankeisei/glossary/
|用語集|大和アセットマネジメント|https://www.daiwa-am.co.jp/guide/term/
|わかりやすい用語集|三井住友DSアセットマネジメント|https://www.smd-am.co.jp/learning/glossary/
|===

=== 東証マネ部
「東証 マネ部！」は身近なお金の話から、プロが教える資産運用のノウハウまで 、資産形成についてわかりやすく解説するサイトです。
今回は、コンペに関係がありそうな記事をピックアップしてみました。コンペティションの息抜きにぜひご確認ください。
[options="header, autowidth"]
|===
|*タイトル* | *リンク*
|投資に不可欠な財務三表の見方|https://money-bu-jpx.com/news/article022723/
|財務ニュースを読む|https://money-bu-jpx.com/news/article028193/
|長期投資に欠かせない運用コストを意識しよう|https://money-bu-jpx.com/news/article004555/
|プロの投資家が注目する指標「ROE」とは？|https://money-bu-jpx.com/news/article005169/
|ディープラーニングが拓く「AI投資」の可能性|https://money-bu-jpx.com/news/article008127/
|AIが導く金融市場の未来|https://money-bu-jpx.com/news/article008332/
|４大投資指標のワナ～解析力の鍛錬～|https://money-bu-jpx.com/news/article012308/
|AIを使った市場の予測に挑む「AlpacaJapan」|https://money-bu-jpx.com/news/article015448/
|「AIと資産運用」| https://money-bu-jpx.com/news/article016485/
|投資に役立つ「会社四季報」活用のポイント|https://money-bu-jpx.com/news/article020860/
|最低投資金額50万円以下の銘柄特集|https://money-bu-jpx.com/news/article022924/
|クチコミで投資を楽しめるアプリ「ferci（フェルシー)」|https://money-bu-jpx.com/news/article023550/
|コロナ後の世界|https://money-bu-jpx.com/news/article024736/
|株式場況を読む～専門用語の理解～|https://money-bu-jpx.com/news/article026712/
|決算ニュースを読む～会計用語の理解～|https://money-bu-jpx.com/news/article027285/
|公的統計を補完する「オルタナティブデータ」とは？|https://money-bu-jpx.com/news/article028023/
|===

=== 参考になる書籍
本コンペティションに参考になる書籍を紹介致します。

[options="header, autowidth"]
|===
| *タイトル* | *著者*　| *概要*
|ファイナンス機械学習―金融市場分析を変える機械学習アルゴリズムの理論と実践|マルコス・ロペス・デ・プラド|機械学習を用いて金融データを分析する上での知識を網羅的に学ぶことができる。金融のドメイン知識をデータサイエンティストが学ぶには最適な本。
|アセットマネージャーのためのファイナンス機械学習|マルコス・ロペス・デ・プラド|ファイナンス機械学習に続き、ノイズ除去、クラスタリング、ラベリング、特徴量の重要度分析などの本コンペでも関連の深いトピックを学ぶことができる。ただし、「ファイナンス機械学習」と比較すると網羅性はないので、2冊目として読むことを推奨。
|Kaggleで勝つデータ分析の技術|門脇 大輔 他|モデルのチューニング・アンサンブルなど機械学習のコンペに関連するテクニックを効率的に学ぶことができる。
|株を買うなら最低限知っておきたい ファンダメンタル投資の教科書 改訂版|足立 武志|ファンダメンタル分析に必要な基礎知識を学ぶことができる。
|経済・ファイナンスデータの計量時系列分析|沖本竜義|ARIMAモデルをベースとした古典的な時系列解析を学ぶことができる。ARIMAモデル自体を予測モデルとして使うことは、コンペではまれだが、金融データに対して時系列分析を実施する上での実務上の課題なども学ぶことができる。
|金融・経済分析のためのテキストマイニング|和泉 潔他|市場レポートや経済ニュースなどのテキストデータを分析し、資産運用や市場分析に活かす手法を解説している。数式は少なく、金融テキストマイニングの独特な注意点や思考法を中心に整理しており、初めて金融分野のテキストマイニングをする人には助かる一冊。
|統計学入門|東京大学教養学部統計学教室 編|文科と理科両方の学生のために，統計的なものの考え方の基礎がやさしく解説されており、統計学の体系的な知識を与えるように，編集・執筆された一冊。
|Pythonデータサイエンスハンドブック|Jake VanderPlas 著、菊池 彰 訳|本チュートリアルにおいても利用されているJupyter、NumPy、pandas、Matplotlib、scikit-learn等をカバーしている一冊。それぞれのトピックについて、押さえておくべき基本、tips、便利なコマンドなどが紹介されている。
|===

=== 参考になるコンペティション
本コンペティションに関連したコンペティションを紹介いたします。

[options="header, autowidth"]
|===
| *タイトル* | *概要*　| *URL*
|Two Sigma: Using News to Predict Stock Movements| ニュースデータを用いた株価の予測 | https://www.kaggle.com/c/two-sigma-financial-news
|Fintech Data Championship| 日本株式のポートフォリオで次の1カ月後に、最も上昇する組み合わせを検討| https://compass.labbase.jp/articles/296
|Algorithmic Trading Challenge　| 投資戦略に関する収益率・取引高等のデータから、各戦略への資金の割り当ての重みを最適化 | https://signate.jp/competitions/146
|大手ヘッジファンドX: 金融モデリングチャレンジ　| 独自に導出した様々な特徴量から将来の動きを予想 | https://signate.jp/competitions/53
|財務・非財務情報を活用した株主価値予測　| 会計年度2014-2017年の各企業の財務・非財務情報から、会計年度2018年の期末時価総額を予測 | https://www.nishika.com/competitions/4/summary
|The Winton Stock Market Challenge| 過去の株価とマスクされた特徴量から将来の株価を予想 | https://www.kaggle.com/c/the-winton-stock-market-challenge
|Numerai| マスクされた銘柄・特徴量から週次で予測結果を提出 | https://numer.ai/
|Quantconnect| 条件を満たしたモデルでリターンを追求 |  https://www.quantconnect.com/competitions
|Bloomberg| ESG要素を効果的に投資判断に組み込んでいるかなどの評価 |  https://www.bloomberg.co.jp/company/stories/investment_contest_2020/
|Jane Street Market Prediction| 株の取引戦略を採用するかどうかを予測 | https://www.kaggle.com/c/jane-street-market-prediction/
|===


=== ファンダメンタルズ分析の活用方法

ファンダメンタルズ分析とは、企業の成長性、収益性、割安性、安定性、効率性などを分析し、投資判断などに活用する手法です。ここでは成長性、収益性、割安性、安定性、効率性の代表的な指標を紹介します。

（**成長性**） +
成長性とは、売上や利益の増加が継続しているかを指し、企業価値の増大に直結する指標です。本コンペのデータでは、純資産や営業利益の上昇率に着目することで、その銘柄の成長性を測ることが出来ます。営業利益の上昇率を計算する場合は、季節性を考慮し、前年同期比と比較することが多いです。

また、年間を通して同一の指標で評価を行いたいときは、直近の四半期のデータで移動平均などを取る方法があります。成長性について利用される様々な指標として売上高増加率、営業利益増加率、経常利益増加率、総資本増加率、純資本増加率、従業員増加率、一株当たり当期純利益（EPS）(成長性分析で企業の成長度を測る 知っておくべき指標や分析方法 より引用 https://keiei.freee.co.jp/articles/c0201686 )などがあります。

なお、過去の成長性を解析することはできますが、その成長性が長期間に渡って継続するかを予測することは、様々な要因が関係するため難しい問題です。また、株価そのものではなく成長性自体をモデルの予測対象にして、その予測に基づき投資を行うスタイルも存在します。

（**収益性**） +
収益性は、営業利益率や経常利益率等を指し、それぞれ営業利益、経常利益を売上高で割ることで計算されます。営業利益率や経常利益率が高い企業は優れたビジネスモデルを保持していたり、販管費を低く保つオペレーションが徹底されていたりすることが多く、優良企業を判断する上での指標となっています。そして、この収益性の変化率を成長性と扱うこともできます。

一般的に投資家が期待する収益性は、業種において大きく異なることに注意が必要です。 +
例えば、様々ある業種のうち、情報通信と食品に期待される営業利益率は大きく異なることが想定されます。この場合、銘柄情報にはセクター情報が含まれているため、セクター平均の営業利益率を計算し、その差分を計算することで、セクター平均からの上振れや下振れを特徴量にすることができます。

（**割安性**） +
株式が割安であるとは、その企業の株価が企業価値と比較して安いということです。代表的な指標としてはPBRが挙げられます。この指標は、企業の純資産と発行済み株式数を割って、1株当たりの純資産を計算します。そして、現在の株価をこの1株当たりの純資産で割ってPBRを求めます。この指標が1を割っている場合は、その企業の本来の価値よりも安い値段で株を買えることになるので、割安であると考えることができます。PBRが高い銘柄をグロース銘柄、低い銘柄をバリュー銘柄として扱いそれぞれ異なる特性を持った銘柄として分析することもあり、企業の状態を知る上で重要な指標です。

現状の日本マーケットにおいては、PBRが1未満の銘柄が数多くあります(Yahooファイナンス 低PBRランキングより引用 https://info.finance.yahoo.co.jp/ranking/?kd=12 )。
これらの極めて割安な銘柄はディープバリュー株と呼ばれています。PBRが低い理由として以下のような理由も考えられますので、PBRをもって一概に割安銘柄とするのではなく、各企業のその他の決算情報を参照するなど、複数の情報を考慮することも重要です。

* 株式市場全体が調整局面にあるなどの理由により、企業実態より株価が売り込まれている。

* 含み損の実現や業績の悪化による純資産の減少を株価が先取りして織り込んで下落している。

* 不人気のため安値に放置されている。


（**安定性**） +
安定性は、大型株や安定性が重視される金融・銀行のような特定のセクターで重視される指標です。安定性を計算する代表的な指標は「自己資本比率」です。 +
「自己資本比率」は総資本における自己資本の割合を計算して得られます。自己資本比率が高ければ、自己資本が多い、つまり返済義務のないお金を潤沢に持っているということになるので「中長期的に見て倒産しにくい会社」ということができ、株式の中長期保有を行う上で倒産リスクを減らすための重要なチェックポイントとなっています。(自己資本比率｜会社経営の「安全性」をあらわす指標 より引用 https://advisors-freee.jp/article/category/cat-big-03/cat-small-08/9011/ )

なお、以下の効率性に関する記載でも紹介しているROEでは、当期純利益と自己資本の割合を見ますが、自己資本が低い株はROEが高くなるので注意が必要です。つまり、借り入れを増やしリスクを取っている銘柄ではROEが高くなりやすく、安定性が低くなる可能性があります。また、小型株においては安定性よりも成長性を重視することもあるという点に注意が必要です。特定のセクターや特定の領域において重要視される指標をモデルに投入する場合、セクターの情報を特徴量として投入するなど、一緒に銘柄を分類できる情報をモデルに投入することで、それらの特性を学ばせることが可能です。

（**効率性**） +
効率性は、近年注目されているROEやROAから計算される指標です。 +
ROEは、当期純利益 ÷ 自己資本 × 100として計算され、自己資本に対してどれだけの利益が生み出されたのかを示します。 +
ROAは、借り入れなどを含む総資産を使ってどれだけ利益を生み出したかを表す指標です。 +
ROEやROAは、効率性を示す指標として注目されており、政府が2017年に公表した成長戦略「未来投資戦略2017」において、「《KPI》大企業（TOPIX500）の ROA について、2025 年までに欧米企業に遜色のない水準を目指す。」(未来投資戦略2017 より引用 https://www.kantei.go.jp/jp/singi/keizaisaisei/pdf/miraitousi2017_sisaku.pdf )というKPIが設定され注目を浴びています。

ROEが高い銘柄ほど効率性が高いと考えることができ、企業価値を高めるための施策としてROEの向上、または維持を目標とする企業が多く、ROE重視の流れの背景は「投資指標としての ROE」(https://www.tr.mufg.jp/houjin/jutaku/pdf/u201503_1.pdf) で詳しく解説されています。

上記のファンダメンタル情報は、本コンペティションで提供されるデータで計算可能ですので、様々なファンダメンタル情報を勉強することは、特徴量設計の次の一歩に繋がるでしょう。

=== テクニカル分析の活用方法

テクニカル分析は、将来の株価の変化を過去に発生した価格や出来高等の時系列パターンから予想・分析しようとする手法であり、メジャーな分析手法の一つです。テクニカル分析にはトレンド分析、オシレーター分析、フォーメーション分析、ローソク足分析(テクニカル指標一覧より引用 https://info.monex.co.jp/technical-analysis/indicators/ )があり、2章においてもオシレーターの代表的な分析手法の一つである「移動平均乖離率」を特徴量の一つとして採用しています。

ここでは、テクニカル分析を更に活用するための注意事項を説明します。テクニカル分析を特徴量として採用する場合、テクニカル分析により得た新規の情報がすでに投入済みの特徴量と比較して、どの程度新しい情報を保持しているか、という観点から考えることが重要です。

例えば、移動平均と移動平均乖離率は、それぞれ似たような情報を保持していることが容易に想像がつきます。これらの情報を特徴量として考えた場合、「20日移動平均乖離率」の方が0平均となるため、定常性を仮定することができ、扱いやすいことから移動平均乖離率を2章では採用しています。 +
ストキャスティクス(詳細は https://info.monex.co.jp/technical-analysis/indicators/006.html を参照)やRSI(詳細は https://info.monex.co.jp/technical-analysis/indicators/005.html を参照)のようなオシレーター系の分析も、似通った情報を保持していることが推測できます。

機械学習のモデル構築において、若干のパラメータを変更したテクニカル分析を複数個特徴量として投入することは、ほとんどの場合良い結果に結びつきません。これは、パラメータ違いのテクニカル分析や同一種類のテクニカル分析は、ほぼ同一の情報を保持していることが多く、複数個特徴量を投入したとしても、パフォーマンスが向上する程の新規の情報を発見することが難しいためです。また、時系列解析はサンプル数が限られていることが多く、特徴量の種類を多くすると学習に必要な十分なデータ量を確保できないため、むやみに特徴量を増やすべきではなく、特徴量自体にパフォーマンス向上に結びつく新しい情報が含まれていることを重視しましょう。

例えば、2章にあるような移動平均乖離率と標準偏差の組み合わせは、お互いに直近時系列に対してトレンドとボラティリティという異なる情報を保持しているため、パフォーマンス向上に期待が持てます。テクニカル分析は順張り系、逆張り系のような系統でくくることができる(第1回 数多くあるテクニカル指標を体系的に解説より引用 https://kabu.com/investment/guide/technical/01.html )ので、それらの系統の中から選択したり、異なる系統として時間時系列に対して依存しない手法、例えば、過去の高値圏にどれだけ近づいているかを計算するような方法なども考えられます。

=== ファクター分析の活用方法

ファクター分析とは、投資が産み出すリターンを説明するファクターを定義し、そのファクターの挙動から分析を行う手法です。

例えば、ファーマ-フレンチの3ファクターモデルでは、株式投資が産み出すリターンをリスクプレミアム、時価総額リスクファクター、簿価時価比率リスクファクターの3要素に分解してます。(Wikipedia ファーマ-フレンチの3ファクターモデルより引用 https://ja.wikipedia.org/wiki/%E3%83%95%E3%82%A1%E3%83%BC%E3%83%9E-%E3%83%95%E3%83%AC%E3%83%B3%E3%83%81%E3%81%AE3%E3%83%95%E3%82%A1%E3%82%AF%E3%82%BF%E3%83%BC%E3%83%A2%E3%83%87%E3%83%AB )

株式投資におけるファクター分析を知っておくことは、どのような特徴量を設計するかという考察を行うために役立ちます。

例えば、主要なファクターである時価総額について考えてみましょう。本コンペで利用できるデータを利用し、株価と発行済株式数から各銘柄の時価総額を計算することができます。一般的にマーケットは小型株が優位なときもあれば、大型株が優位なときもあるため、どちらに投資するべきかを簡単に決めることはできません。しかし、この時価総額が株価のリターンの説明要因の一つであるということを知っていれば、少なくとも特徴量に追加することで何らかの学習を行える可能性があるのではと考える事ができます。時価総額が入力データに含まれていない場合、モデルは時価総額ファクターに関連した相場変動を理解することが難しくなりますので、特徴量として投入したほうが良さそうだということが推測されます。

また、近年新たな投資手法として現れたスマートベータ投資も、このファクター分析を利用したアプローチの一つであり、ファクター分析は新しい投資手法を考える上で、基礎知識の一つになっています。スマートベータ投資とは、特定のファクターをベンチマークとして制御する手法です。具体的には、高配当、バリュー、低リスク、最小分散、クオリティ、モメンタム、及びこれらの組み合わせ等が、ベンチマークとして制御するファクターの候補となっています(スマートベータとリターン特性についてより引用 https://www.mizuho-ir.co.jp/publication/report/2020/fe36.html )。

ファクター分析で扱われているファクターは、リターンの要因として定義され、株価にも何らかの影響力があると考えられたものです。様々なファクターについて勉強することが、特徴量設計の次の一歩に繋がるでしょう。

=== 複数個のモデルの出力をアンサンブルするアプローチ

アンサンブルの活用について説明します。機械学習における「アンサンブル」とは、複数のモデルを組み合わせることでパフォーマンスの高いモデルを作成する手法を意味します。アンサンブルに使うモデルは多様性があればある程基本的には好ましく、多様性のあるモデルを作り、最終的にアンサンブルすることで、単一モデルでは達成できないパフォーマンスを最終的に達成する可能性があります。

アンサンブルには、シンプルに複数のモデルの出力の平均を取るモデル平均法、scikit-learnライブラリのStandardScaler( https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html )による標準化を実施して分布をある程度揃えてから足し合わせる方法などがあります。また、より高度な手法であるスタッキングもscikit-learnライブラリにはStackingClassifer/StackingRegressorがあるため容易に実施(スタッキングで分類・回帰 (scikit-learn) より引用 https://qiita.com/maskot1977/items/de7383898123fa378d86 )することが可能です。kaggleで活用されている様々なアンサンブルの方法がKAGGLE ENSEMBLING GUIDE( https://mlwave.com/kaggle-ensembling-guide/ )では紹介されており、英文ですが読む価値があります。

ここでは、時価総額に着目して学習の対象を分けて複数個のモデルを作るアプローチを考えてみます。一般的に時価総額が低い銘柄は、大きな値動きが発生しやすいことが知られています。これは市場の流動性に違いがあり、同一額の投資が発生しても、小型株のほうがよりインパクトが大きいためです。今回のコンペティションでは、全銘柄を予測対象としていますが、実際にモデルを作ると全銘柄の時価総額の下位の銘柄を学習対象から除外すると、よりモデルのパフォーマンスが高くなることがあります。これは時価総額が低い銘柄は、ランダム性がより高く、またファンダメンタルに従わないことが多いためです。

では、以下の2つのモデルをつくった場合を考えてみます。

*A*: 全銘柄を対象に学習したモデル

*B*: 時価総額の下位の銘柄を学習から除外した上で、パフォーマンスをチューニングしたモデル

この2つが異なることを学習したとした場合、Bのモデルの出力に対してStandardScalerによる標準化を実施し、Aのモデルの出力に足し合わせると、Bのモデルが学んだことをBの学習対象の銘柄に足し合わせることができます。Bの出力に対しては、StandardScalerによる標準化を実施しているため分布が0平均となっており、学習対象外の銘柄に対する影響も限定することができます。

異なる特性をもったデータを学習させることで、モデルが異なることを学び、結果的にモデル同士の出力の相関が低くなります。モデル間の出力の相関が低いもの同士をアンサンブルさせると、相関の高いもの同士をアンサンブルさせた時よりも、アンサンブルの効果は高く出ることが多いため、上記のように学習対象を変えることで複数のモデルを作り、アンサンブルを実施するようなアプローチは有用です。

=== プライベート期間の性能の向上のために考慮すべきこと

金融時系列はサンプル数が少ないため、特徴量を大量に生成し、特徴量選択をすべてモデルに任せるアプローチを採用する場合、ライブ性能の劣化に注意する必要があります。特徴量をどんどん増やすと、訓練期間のパフォーマンスは伸びていても、評価期間のパフォーマンスの向上が止まることがあります。100種類のデータを使うモデルと10種類のデータを使うモデルが、同一の訓練期間で同一の精度を達成した場合、評価期間・ライブ期間では、少ないデータを使ったモデルの方が高い性能を期待できる可能性が高いことが、経験的にわかっています。これは、説明変数の取りうるパターンが多いと、未来で同じ現象を発生する確率が下がっていくためと考えられます。モデルの複雑さとデータへの適合度とのバランスを取るためには、オッカムの剃刀(Wikipedia オッカムの剃刀より引用 https://ja.wikipedia.org/wiki/%E3%82%AA%E3%83%83%E3%82%AB%E3%83%A0%E3%81%AE%E5%89%83%E5%88%80 ) のような発想が必要となります。

=== 本コンペでは利用できないが、モデルを将来的に発展させるために検討する価値のある外部データ

日本株のデータ以外に特徴量設計に利用可能と思われるデータを紹介します。本コンペでは、あらかじめ定められたデータしか利用することはできませんが、今後手元で新たなモデルを作成するときの知識としてご活用下さい。

*為替データ*: ドル円の値動きが株式市場に影響を与えていることはよく知られています。特に日本市場の株式は輸出関連銘柄が多いため、ドル円の値動きは直接収益に関連します。よって、為替データを説明変数に採用するアプローチも想定されます。為替データは、いくつかのFX会社がAPIを提供しています。

*金利データ*: 金利データとは、例えば米国債10年金利のような各国の債券の金利を指します。一般的に、機関投資家は債券と株式の両方を投資対象とするため、債券市場の動きは株式市場に反映されます。こちらは、APIによるデータ習得は容易ではありませんが、そこまで数は多くないため、説明変数として利用することは難しくありません。

*米国株データ*: Alpaca US( https://alpaca.markets/data )やIEX Cloud( https://iexcloud.io/ )など、様々な米国株の株価/ETFのデータを提供するサービスが存在します。日本株式のマーケットは、米国株式のマーケットクローズ後にオープンするため、米国市場が日本市場に与える影響を解析することで、様々な情報を分析することが可能です。

他にも政府が発表するGDPなどの各国の経済動向、金などのコモディティ市場も、密接に株式市場の長期トレンドの形成に関わっていますので、様々な外部データの利用を検討することで新たなモデルを作ることができる可能性があります。

=== モデルの再学習の運用について

長期間に渡りモデルを運用しようとする場合、再学習の運用を考慮しておく必要があります。再学習の運用とは、例えば2019年までのデータを用いてモデルを学習し2020年で運用した場合、2020年末に2020年のデータを用いて再学習を行うといったようなことを指します。再学習を行うにあたっていくつか考慮しておくべきポイントを紹介します。

==== 再学習を行う必要があるほど新規のデータが存在するか

再学習は、新規のデータが溜まった時に実施します。モデルにも依存しますが、モデルが挙動を変えるには、既存の学習に用いたデータ量と比較してある程度の量の新規データが存在しないと、再学習を実施してもモデルの挙動は変わりません。再学習する際に有用な新規データ量は一概には言えず、モデルによって変わります。毎日モデルをトレーニングするような運用も可能ですが、データ量が多少増えただけでは、ほぼ同じ挙動となる可能性が高いです。

==== 再学習を行うことでモデルの出力分布が変わらないか

こちらは、システムで運用する場合に発生しやすい問題です。例えば、投資する際の購入タイミングを、モデルの出力が0.8以上といったしきい値を用いた実装をしていたとします。この際に再学習を行うことでモデルの出力が変わると、想像以上に購入したり、逆に購入を実施しなくなったりします。再学習を行った場合、直近数週間程度のデータは利用せずに、古いモデルと新しいモデルで出力を比較し、出力の分布が変わっていないことを確認するのが良いでしょう。


=== Google Colaboratoryの使用法

Google Colaboratoryは、ブラウザから Python をノートブック形式で記述、実行できるサービスです。環境構築が不要となっており、本チュートリアルもGoogle Colaboratoryで実行することが可能となっています。また、時間等の制限はございますがGPUを利用できることや、ノートブックの共有が簡単にできることなど、多くの利点を備えています (link:https://colab.research.google.com/notebooks/intro.ipynb?hl=ja#[参考元]  )。

==== *Colab でノートブックが動作する時間は？*

本チュートリアルをGoogle Colaboratoryで実行する際には時間制限にご注意ください。ノートブックは、インスタンスが起動された後 12 時間経過すると自動的にランタイムがリセットされ実行環境が初期化されます。また、ノートブックのアイドル状態が 90 分続くとタイムアウトし、こちらもランタイムがリセットされます。(詳細はlink:https://research.google.com/colaboratory/faq.html#:~:text=How%20long%20can%20notebooks%20run,or%20based%20on%20your%20usage[Google ColaboratoryのQ&A]をご参照ください。)。


==== 本コンペでGoogle Colaboratoryを使用するために

本コンペの2章のチュートリアルをGoogle Colaboratory上で動かすためには、まず以下の手順でGoogle Drive上にファイルを設置します。

1. Google DriveのMy Driveに``JPX_competition``というフォルダーを作成します。

2. SIGNATEのコンペティションサイトよりダウンロードした各種データを1で作成したフォルダーにアップロードします。

次にGoogle Colaboratory上でチュートリアルのノートブックを展開します。ノートブックはGoogle Colaboratory上でも実行可能となっており、そのまま編集なしで実行できます。以下、具体的な方法を説明します。

1. ノートブックをダウンロードします。 link:https://github.com/JapanExchangeGroup/J-Quants-Tutorial/blob/main/handson/Chapter02/20210121-chapter02-tutorial.ipynb[こちらのGithubリポジトリ]よりRawボタンを右クリックし、「リンク先を名前をつけて保存」を選択して先程作成した``JPX_competition``に保存してください。

2. Google Driveにアップロードした `20210121-chapter02-tutorial.ipynb` ファイルをダブルクリックして Google Colaboratory で開きます。

3. コンペティションデータをノートブックで読み込むために、Google Driveへマウントします。マウント方法についてはlink:https://qiita.com/kado_u/items/45b76f9a6f920bf0f786[こちら]の記事をご参照ください。

=== 内国株の売買制度
本節では、本コンペティションの題材となっている株式の売買制度について説明します。

==== 制限値幅
東京証券取引所では、一日の売買における値動きの幅を価格水準に応じて一定に制限しており、この値幅を **制限値幅** といいます。制限値幅は、前日の終値又は最終気配値段など（以下、「基準値段」と言います）を基準としており、その値幅の大きさは基準値段によって異なります。詳細はlink:https://www.jpx.co.jp/equities/trading/domestic/06.html[こちら]をご参照ください。

==== 呼値の単位
内国株式の売買の注文をする際の値段の刻みことを **呼値の単位** といい、この呼値の単位は、売買の対象となる銘柄及びその値段の水準に応じて異なります。各値段の水準における詳細な呼値の単位については、link:https://www.jpx.co.jp/equities/trading/domestic/07.html[こちら]をご参照ください。なお、銘柄によっては呼値の単位は整数ではなく、小数点があるものもございますのでご留意ください。
